C**AGISZ
C  Continuum Dynamics, Inc.
C  AGDISP Version 8.29 06/16/16
C
      SUBROUTINE AGISZ(LSTAB,SO,X,XZ,SZ,B)
C
C  AGISZ determines the ISC coefficients for Z
C
C  LSTAB  - Stability identifier
C  SO     - Initial spread (m)
C  X      - Downwind distance from handoff (m)
C  XZ     - Virtual distance (m)
C  SZ     - Spread (m)
C  B      - Power law coefficient
C
      DIMENSION IBS(6),IES(6)
      DIMENSION XDIS(32),ASDC(32),BSDC(32),RSDC(32),SSDC(32)
C
      DATA IBS /  1,  9, 12, 13, 18, 25 /
      DATA IES /  8, 11, 12, 17, 24, 32 /
C
      DATA XDIS /    100.0,     150.0,      200.0,     250.0,     300.0,
     $               400.0,     500.0,     3110.0,                        !A
     $               200.0,     400.0,    20000.0,                        !B
     $             20000.0,                                               !C
     $               300.0,    1000.0,     3000.0,   10000.0,   20000.0,  !D
     $               100.0,     300.0,     1000.0,    2000.0,    4000.0,
     $             10000.0,   20000.0,                                    !E
     $               200.0,     700.0,     1000.0,    2000.0,    3000.0,
     $              7000.0,   15000.0,    20000.0 /                       !F
C
      DATA ASDC / 0.17992 ,  0.10871 ,  0.08942  ,  0.07508 ,  0.03500 ,
     $            0.015308,  0.0022652, 0.00020282,                       !A
     $            0.14506 ,  0.11051 ,  0.055889 ,                        !B
     $            0.11025 ,                                               !C
     $            0.084739,  0.11869 ,  0.37525  ,  0.51347 ,  0.73520 ,  !D
     $            0.075005,  0.081143,  0.11620  ,  0.27714 ,  0.43473 ,
     $            0.75325 ,  1.07026 ,                                    !E
     $            0.054370,  0.064249,  0.12323  ,  0.17695 ,  0.34344 ,
     $            0.65233 ,  1.01412 ,  2.36950  /                        !F
C
      DATA BSDC / 0.94470 ,  1.05420 ,  1.09320  ,  1.12620 ,  1.26440 ,
     $            1.40940 ,  1.72830 ,  2.11660  ,                        !A
     $            0.93198 ,  0.98332 ,  1.09710  ,                        !B
     $            0.91465 ,                                               !C
     $            0.86974 ,  0.81066 ,  0.64403  ,  0.60486 ,  0.56589 ,  !D
     $            0.83660 ,  0.81956 ,  0.75660  ,  0.63077 ,  0.57154 ,
     $            0.50527 ,  0.46713 ,                                    !E
     $            0.81558 ,  0.78407 ,  0.68465  ,  0.63227 ,  0.54503 ,
     $            0.46490 ,  0.41507 ,  0.32681  /                        !F
C
      DATA RSDC / 6.14481 ,  8.20688 ,  9.10326  ,  9.95726 , 14.17336 ,
     $           19.40166 , 33.91014 , 55.61882  ,                        !A
     $            7.93694 ,  9.39340 , 13.86134  ,                        !B
     $           11.14225 ,                                               !C
     $           17.07884 , 13.85944 ,  4.58101  ,  3.01021 ,  1.72219 ,  !D
     $           22.11134 , 21.42379 , 17.19901  ,  7.64735 ,  4.29531 ,
     $            1.75208 ,  0.86470 ,                                    !E
     $           35.51484 , 33.14705 , 21.28619  , 15.47350 ,  7.10577 ,
     $            2.50659 ,  0.96679 ,  0.071383 /                        !F
C
      DATA SSDC / 1.05854 ,  0.94859 ,  0.91475  ,  0.88794 , 0.79089  ,
     $            0.70952 ,  0.57860 ,  0.47259  ,                        !A
     $            1.07298 ,  1.01696 ,  0.91149  ,                        !B
     $            1.09331 ,                                               !C
     $            1.14977 ,  1.23356 ,  1.55272  ,  1.65328 ,  1.76713 ,  !D
     $            1.19531 ,  1.22017 ,  1.32170  ,  1.58536 ,  1.74966 ,
     $            1.97914 ,  2.14073 ,                                    !E
     $            1.22597 ,  1.27540 ,  1.46060  ,  1.58160 ,  1.83476 ,
     $            2.15100 ,  2.40923 ,  3.05988  /                        !F
C
      IBEG=IBS(LSTAB)
      IEND=IES(LSTAB)
      I=IBEG-1
10    I=I+1
      A=ASDC(I)
      B=BSDC(I)
      R=RSDC(I)
      S=SSDC(I)
      XZ=R*SO**S
      IF (X+XZ.GT.XDIS(I).AND.I.LT.IEND) GOTO 10
      IF (X+XZ.LE.0.0) THEN
        SZ=0.0
      ELSE
        SZ=AMIN1(A*(X+XZ)**B,5000.0)
      ENDIF
      RETURN
      END