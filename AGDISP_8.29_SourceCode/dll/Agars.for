C**AGARS
C  Continuum Dynamics, Inc.
C  AGDISP Version 8.29 06/16/16
C
      SUBROUTINE AGARS(BBK,IUNIT,LFL,ICLS,NPTS,DDV,XXV,IER,
     $                 REALWD,CHSTR,JCHSTR)
!MS$ATTRIBUTES DLLEXPORT,STDCALL :: AGARS
!MS$ATTRIBUTES REFERENCE :: BBK
!MS$ATTRIBUTES REFERENCE :: IUNIT
!MS$ATTRIBUTES REFERENCE :: LFL
!MS$ATTRIBUTES REFERENCE :: ICLS
!MS$ATTRIBUTES REFERENCE :: NPTS
!MS$ATTRIBUTES REFERENCE :: DDV
!MS$ATTRIBUTES REFERENCE :: XXV
!MS$ATTRIBUTES REFERENCE :: IER
!MS$ATTRIBUTES REFERENCE :: REALWD
!MS$ATTRIBUTES REFERENCE :: CHSTR
!MS$ATTRIBUTES REFERENCE :: JCHSTR
C
C  AGARS runs the revised USDA ARS analysis, then reconstructs the
C  drop size distribution by calling the appropriate function
C
C  BBK    - BKDATA data structure
C  IUNIT  - Units flag: 0 = English; 1 = metric
C  LFL    - Operations flag: 0 = initialization of calculation
C  ICLS   - Size class flag: -1 = no; 0-10XX = class to use
C  NPTS   - Number of points in drop size distribution
C  DDV    - Drop size distribution array
C  XXV    - Volume fraction array
C  IER    - Error flag: 0 = No warning or error message
C                       1 = Write warning information
C                       2 = Write error information and continue
C                       3 = Write error information and return
C  REALWD - Real data array (value, minimum, maximum)
C  CHSTR  - Character string
C  JCHSTR - Length of character string
C
      INCLUDE 'AGDSTRUC.INC'
C
      RECORD /BKDATA/ BBK
C
      CHARACTER*40 CHSTR,ANG(2,2)
C
      DIMENSION REALWD(3),DDV(2),XXV(2),ICHR(2,2),IANG(15)
      DIMENSION D01(15,15,2),D05(15,15,2),D09(15,15,2)
      DIMENSION CSUB1(15,2),CSUB2(15,2),CSUB3(15,2),CSUB4(15,2)
      DIMENSION CDIV1(15,2),CDIV2(15,2),CDIV3(15,2),CDIV4(15,2)
C
      COMMON /ARS/ NS
C
C  01  Ceramic Disc Core 45, Low Speed
      DATA D01(1:15,1,1) /
     $     114.5804,    21.1280,   -11.2168,    -9.4581,    -4.9368,
     $      -2.1706,    -2.7033,     3.6624,    -1.2046,    -2.4609,
     $       3.0118,    -2.2837,    -6.9932,     7.1224,     4.9724 /
      DATA D05(1:15,1,1) /
     $     260.2456,    51.5909,   -21.5639,   -20.5684,   -15.7846,
     $      -6.5238,    -7.7431,     9.2283,    -3.1505,    -3.1726,
     $       6.4122,    -2.8063,   -15.5865,     9.3630,     5.1628 /
      DATA D09(1:15,1,1) /
     $     474.7400,   108.9529,   -41.7767,   -25.4634,   -16.0900,
     $     -18.8533,     0.1951,    12.7333,     3.0520,    -2.4805,
     $      15.5497,    -0.8967,   -12.4831,    -1.8271,     6.2554 /
C
C  01  Ceramic Disc Core 45, High Speed
      DATA D01(1:15,1,2) /
     $      71.1847,    10.0618,   -17.1703,     0.8224,   -12.4890,
     $      -6.5178,    -1.7288,     1.8057,    -1.5968,     1.0688,
     $       0.8397,    -1.4562,     3.1030,    -2.1967,     0.3670 /
      DATA D05(1:15,1,2) /
     $     176.9451,    27.3514,   -37.0359,     1.7993,   -27.8294,
     $     -13.5128,    -3.0334,     4.5241,    -3.7212,     1.5207,
     $       1.3641,   -10.7186,     4.0173,    -3.9906,    -0.3657 /
      DATA D09(1:15,1,2) /
     $     333.1581,    57.9618,   -69.9943,     7.7274,   -47.5442,
     $     -29.8930,     1.2961,     6.4149,    -4.0899,     4.5011,
     $       1.0617,   -26.8615,     9.0126,     0.0108,   -27.2035 /
C
C  02  Ceramic Disc Core Straight Stream, Low Speed
      DATA D01(1:15,2,1) /
     $     376.3673,   -62.1370,  -151.3552,     0.5395,   -69.7047,
     $      52.0312,    11.4030,    54.6033,    67.9913,    16.7172,
     $      15.1858,    34.2124,     2.9389,   -32.1383,    53.5031 /
      DATA D05(1:15,2,1) /
     $     885.0390,   -50.3279,  -293.9228,    50.8237,  -127.9211,
     $      48.0503,     4.9112,    70.2853,    76.8811,    14.3851,
     $      -1.6186,    67.7053,   -17.9754,   -99.4076,    85.7484 /
      DATA D09(1:15,2,1) /
     $    1600.5724,    57.9864,  -368.3654,   111.8713,  -159.9267,
     $      76.5037,   -26.2986,    71.2458,    63.2345,   -78.5873,
     $      21.5816,    14.5398,   -34.4488,  -122.0951,    56.9519 /
C
C  03  CP-03, Low Speed
      DATA D01(1:15,3,1) /
     $     155.7022,    15.1769,   -55.0595,    -7.3333,   -35.8510,
     $      -7.8858,    -3.8931,     7.9703,   -10.5077,     9.3877,
     $       4.3142,     3.8580,    -8.2829,     6.4788,    18.9872 /
      DATA D05(1:15,3,1) /
     $     364.1359,    69.5290,  -114.6228,   -18.2060,   -88.1560,
     $     -46.2372,    -3.0879,    18.5319,   -14.4860,    34.4644,
     $       4.4845,    -2.6820,   -29.8425,     5.9153,    53.4676 /
      DATA D09(1:15,3,1) /
     $     684.8724,   151.3475,  -227.1889,     1.6319,  -231.2922,
     $     -69.2045,    10.1876,     4.0997,   -42.2276,    87.3920,
     $     -38.7806,   -74.5297,   -30.3857,    -0.3231,   120.4365 /
C
C  03  CP-03, High Speed
      DATA D01(1:15,3,2) /
     $      82.8772,     3.2461,   -22.5719,    -1.9537,   -15.8125,
     $      -2.5401,     1.4491,     1.2689,     0.5978,     4.9492,
     $      -1.7662,     5.1946,     2.5750,     0.5648,    -5.3322 /
      DATA D05(1:15,3,2) /
     $     198.7793,    16.3675,   -52.6885,     1.9103,   -35.6004,
     $      -8.4508,     2.8141,    -0.9261,     0.1724,    10.7123,
     $      -4.6577,     1.4505,     8.9317,     1.0121,    -3.8402 /
      DATA D09(1:15,3,2) /
     $     359.3421,    50.5174,  -109.3464,    25.8240,   -84.9782,
     $     -23.9624,     4.1525,   -28.3608,     5.8989,    18.7430,
     $      -7.8313,   -14.6485,    29.2485,    26.8397,   -13.8984 /
C
C  04  CP-09, Low Speed
      DATA D01(1:15,4,1) /
     $     216.9059,    29.8370,   -89.3828,    -7.9128,   -25.8764,
     $     -31.1212,     5.8000,    24.0703,   -12.1399,    -0.2033,
     $       5.5320,   -12.7892,     4.8510,     8.7057,     0.0000 /
      DATA D05(1:15,4,1) /
     $     536.6679,   106.4013,  -210.0515,   -11.6524,   -84.3607,
     $    -109.6685,    24.8407,    52.1177,   -19.0467,    17.3530,
     $      13.3061,   -13.1074,    -1.6733,    -6.2676,     0.0000 /
      DATA D09(1:15,4,1) /
     $    1020.5259,   201.0977,  -368.7465,    24.6793,  -208.5754,
     $    -152.2264,    67.0564,    27.1637,    -7.0570,     4.2382,
     $     -17.6524,   105.5909,   -31.4425,   -96.4074,     0.0000 /
C
C  04  CP-09, High Speed
      DATA D01(1:15,4,2) /
     $      62.2759,    -5.0616,   -41.3849,    11.4612,   -37.4518,
     $       4.9438,   -11.3916,   -13.5102,    10.8326,    14.0342,
     $     -10.2401,    -2.7581,    14.0445,     3.5972,    54.3854 /
      DATA D05(1:15,4,2) /
     $     109.2070,   -10.9466,  -112.5253,    44.3979,  -114.8310,
     $      18.0409,   -38.1078,   -48.8317,    27.6676,    41.8002,
     $     -32.8022,   -12.3607,    43.6481,    13.7889,   190.5735 /
      DATA D09(1:15,4,2) /
     $     300.8848,    25.4515,  -214.0946,    94.4398,  -208.9860,
     $      21.5472,   -56.6161,  -122.7420,    36.3935,    69.8678,
     $     -55.2960,    18.6384,    91.2341,    52.8274,   199.7446 /
C
C  05  CP-09 Straight Stream, Low Speed
      DATA D01(1:15,5,1) /
     $     417.5952,   -38.5559,  -171.0470,    -4.3782,     0.0000,
     $       6.0470,    53.0214,    15.5733,     0.0000,     0.0000,
     $       0.0000,   -73.9470,    58.7407,   -40.6062,     0.0000 /
      DATA D05(1:15,5,1) /
     $     955.8739,    -7.6909,  -361.3222,    58.1554,     0.0000,
     $     -32.1388,    66.6015,   -11.1127,     0.0000,     0.0000,
     $       0.0000,  -151.9264,    94.1492,   -59.8117,     0.0000 /
      DATA D09(1:15,5,1) /
     $    1617.2401,    38.5833,  -487.3806,   170.1709,     0.0000,
     $     -22.9929,    70.1645,   -55.4207,     0.0000,     0.0000,
     $       0.0000,  -109.2743,   121.1757,  -121.2615,     0.0000 /
C
C  06  CP-11TT 20 deg Flat Fan, Low Speed
      DATA D01(1:15,6,1) /
     $     258.6999,    57.2195,   -82.6856,   -33.1765,   -72.4292,
     $     -40.4576,   -11.8024,    37.8508,   -17.9326,    12.0955,
     $      16.1860,    -6.7903,     3.6039,   -28.7248,    23.6547 /
      DATA D05(1:15,6,1) /
     $     621.3992,   146.2487,  -152.4465,   -48.4272,  -116.7462,
     $     -88.2541,   -17.8126,    56.0536,   -32.9506,     0.1865,
     $      10.2850,   -33.1885,    -0.6973,   -59.9098,    18.9017 /
      DATA D09(1:15,6,1) /
     $    1171.5676,   271.6940,  -232.3356,   -45.0115,  -177.6461,
     $    -135.5744,    -9.3778,    73.4240,   -50.0558,   -40.4701,
     $     -10.7994,   -71.2248,   -63.0915,   -91.8782,     3.5792 /
C
C  06: CP-11TT 20 deg Flat Fan, High Speed
      DATA D01(1:15,6,2) /
     $      87.4949,    14.5056,   -28.4556,     6.2889,   -49.2500,
     $      -6.1125,     3.3125,     1.9125,    -4.5500,    14.6000,
     $      -6.1250,    -4.8274,     4.8226,     0.9226,    15.6726 /
      DATA D05(1:15,6,2) /
     $     217.3830,    34.1222,   -62.2111,    12.2000,  -104.9610,
     $     -16.7000,     8.9875,     1.5375,   -17.7000,    35.7750,
     $     -20.7375,    -6.3469,    13.2531,     1.2531,    28.4031 /
      DATA D09(1:15,6,2) /
     $     382.3559,    85.5500,  -115.9389,    26.0000,  -213.8280,
     $     -28.0375,    15.4250,     0.5000,   -52.4875,    67.0375,
     $     -43.6000,    -6.3652,    27.8348,     5.1847,    63.4348 /
C
C  07  CP-11TT 40 deg Flat Fan, Low Speed
      DATA D01(1:15,7,1) /
     $     219.1274,    36.2852,   -41.8429,   -13.7363,   -37.0477,
     $     -21.5307,     4.0173,    14.4361,   -23.0196,     6.6915,
     $     -11.3316,   -12.4384,    -7.5354,    -4.5033,   -12.8193 /
      DATA D05(1:15,7,1) /
     $     531.6870,   123.4245,   -85.3101,   -30.1595,   -85.4638,
     $     -53.4279,    -6.3706,    32.4594,   -59.4163,    21.2162,
     $     -24.2120,   -55.5730,   -28.2052,   -15.2239,   -37.4012 /
      DATA D09(1:15,7,1) /
     $    1003.5011,   280.7905,  -157.8267,   -42.8771,  -172.3139,
     $     -97.7451,   -14.1410,    53.4130,  -123.8780,    17.4700,
     $     -46.9701,  -107.4298,   -69.0759,   -48.8389,   -54.3704 /
C
C  07  CP-11TT 40 deg Flat Fan, High Speed
      DATA D01(1:15,7,2) /
     $      82.8487,     9.8471,   -24.8931,     2.0625,   -42.5419,
     $      -5.9810,     3.2891,    -0.0596,    -3.6190,    16.8896,
     $      -7.7539,    -7.5747,     3.0292,     0.2364,    16.8765 /
      DATA D05(1:15,7,2) /
     $     208.4340,    30.9614,   -57.6972,     6.0939,   -93.1330,
     $     -16.7114,     9.1007,    -0.3490,   -13.4784,    33.7882,
     $     -18.1422,   -20.3663,    10.1757,    -1.9591,    35.3847 /
      DATA D09(1:15,7,2) /
     $     368.0412,    82.7236,  -106.5266,    17.9592,  -189.7160,
     $     -30.6977,    21.6246,    -8.8622,   -48.8614,    60.5230,
     $     -41.8411,   -38.3028,    27.1283,    -5.0211,    79.4328 /
C
C  08  CP-11TT 80 deg Flat Fan, Low Speed
      DATA D01(1:15,8,1) /
     $     178.3055,    31.7301,   -22.9892,    -8.8092,   -28.1366,
     $      -3.1650,    -0.6599,     9.5429,   -24.8720,     6.4700,
     $      -1.9501,   -19.4515,   -15.4030,     2.9760,   -13.2494 /
      DATA D05(1:15,8,1) /
     $     419.9751,    93.8769,   -37.5185,   -18.1526,   -72.2693,
     $     -16.1091,    -1.5674,    18.2428,   -61.0317,    29.7472,
     $      -1.5817,   -61.7781,   -26.9668,     6.7362,   -48.1751 /
      DATA D09(1:15,8,1) /
     $     771.9835,   204.2540,   -75.2975,   -33.3823,  -143.7814,
     $     -42.0633,    -2.7525,    32.2947,  -122.1024,    54.6917,
     $     -12.8527,  -119.0688,   -43.9714,     7.3694,  -101.3276 /
C
C  08  CP-11TT 80 deg Flat Fan, High Speed
      DATA D01(1:15,8,2) /
     $      80.3911,    15.3801,   -19.1401,     0.0057,   -24.7577,
     $      -7.0297,     1.7830,     0.3822,    -8.5850,     7.8309,
     $      -2.3822,   -13.0232,     2.7540,    -0.8015,     9.3967 /
      DATA D05(1:15,8,2) /
     $     198.7351,    40.9078,   -41.1522,     0.2703,   -53.5934,
     $     -16.1245,     4.8201,     2.9198,   -21.8673,    13.4514,
     $      -4.9291,   -29.7470,     5.9512,    -2.7308,    17.8526 /
      DATA D09(1:15,8,2) /
     $     345.2431,    87.8584,   -66.2710,     3.2716,  -110.8330,
     $     -23.3256,    11.5979,    12.2104,   -52.5524,    19.3814,
     $     -15.2276,   -55.8081,     8.0831,    -9.3177,    48.9498 /
C
C  09  CP-11TT Straight Stream, Low Speed
      DATA D01(1:15,9,1) /
     $     354.8862,    -9.4742,  -100.8258,    12.2012,   -46.7600,
     $     -12.1580,    -9.1156,    19.8114,    22.0144,    19.4071,
     $      22.0785,   -68.1469,    11.6855,    -0.8715,    35.6203 /
      DATA D05(1:15,9,1) /
     $     778.7614,   -11.0120,  -203.3351,    41.6994,  -121.3211,
     $     -21.9555,   -36.0490,    25.1976,    55.9186,    46.3167,
     $      16.9570,   -97.6473,    37.8750,   -35.3368,    58.1720 /
      DATA D09(1:15,9,1) /
     $    1467.3524,    37.9919,  -283.7195,   116.3527,  -176.6463,
     $     -27.1480,   -32.8695,    49.4117,    64.2342,    17.6972,
     $      -7.2725,   -75.6530,   -17.0417,   -86.3554,    46.7982 /
C
C  09  CP-11TT Straight Stream, High Speed
      DATA D01(1:15,9,2) /
     $     119.4535,   -10.1872,   -54.7197,    21.5085,   -52.8923,
     $       3.4273,    -1.8292,   -12.0883,    14.6150,    28.3362,
     $     -20.2415,     3.7448,    15.7868,     0.9818,     7.3041 /
      DATA D05(1:15,9,2) /
     $     291.0904,   -14.8728,  -127.5481,    59.5501,  -123.6880,
     $       7.4343,    -8.5687,   -37.5109,    27.6523,    64.7024,
     $     -53.6263,     7.1775,    39.1187,     2.8444,    18.8152 /
      DATA D09(1:15,9,2) /
     $     568.6660,    -9.1869,  -233.8423,   126.4276,  -240.1380,
     $       2.8396,   -23.4533,   -90.1549,    48.1711,   112.0114,
     $    -117.5260,    28.2184,    92.3359,    -2.6694,    -2.3928 /
C
C  10  Davidon Tri-Set, Low Speed
      DATA D01(1:15,10,1) /
     $     182.0653,    -9.4009,   -68.6759,   -20.5199,   -15.0503,
     $      17.6071,     0.3707,    36.3121,   -20.5758,   -10.2387,
     $      -8.3894,   -29.7524,     8.9682,    26.4320,     0.0000 /
      DATA D05(1:15,10,1) /
     $     424.0966,     9.0880,  -114.3328,   -31.9211,   -50.8529,
     $      19.4108,    -4.9088,    63.5508,   -38.5757,    15.3916,
     $     -20.4604,   -75.7497,   -10.0691,    52.6109,     0.0000 /
      DATA D09(1:15,10,1) /
     $     787.6961,    66.3057,  -242.2386,    -8.5560,  -125.1025,
     $       4.3297,    -9.1529,    60.3511,   -49.6142,    60.0048,
     $     -59.5811,  -218.6968,    14.9021,   122.2964,     0.0000 /
C
C  10  Davidon Tri-Set, High Speed
      DATA D01(1:15,10,2) /
     $     102.5435,    -7.7112,   -58.0160,    26.9446,   -67.5103,
     $      -0.9860,    20.2018,   -18.1157,     4.3087,    45.4093,
     $     -30.8049,     2.7623,    13.1017,    -0.3206,    30.5679 /
      DATA D05(1:15,10,2) /
     $     242.7426,    -4.4283,  -134.3129,    74.3681,  -167.4650,
     $      -8.1497,    55.8518,   -47.4177,     5.6829,   105.0998,
     $     -82.3799,    -3.7092,    30.6210,     2.6141,    92.3036 /
      DATA D09(1:15,10,2) /
     $     451.5393,    12.2106,  -216.9586,   133.8671,  -307.6640,
     $      -9.4468,    90.7375,   -79.0649,    -3.3835,   162.5248,
     $    -144.6830,   -16.0963,    53.0577,    -0.4292,   151.8336 /
C
C  11  Davidon Tri-Set Straight Stream, Low Speed
      DATA D01(1:15,11,1) /
     $     498.0239,  -119.5144,  -363.9462,    71.7400,     0.0000,
     $      85.0657,   -19.3914,   -22.8868,     0.0000,     0.0000,
     $       0.0000,    43.5037,   169.9693,   -67.7182,     0.0000 /
      DATA D05(1:15,11,1) /
     $    1148.7007,   -69.3688,  -619.0458,   172.3496,     0.0000,
     $      21.5978,    -7.9091,   -32.8285,     0.0000,     0.0000,
     $       0.0000,   -43.0118,   199.7623,   -24.9700,     0.0000 /
      DATA D09(1:15,11,1) /
     $    1818.0000,    -6.0588,  -696.2853,   204.8039,     0.0000,
     $       5.8978,   -21.8493,    72.9231,     0.0000,     0.0000,
     $       0.0000,   -63.2720,   195.3446,    -6.1275,     0.0000 /
C
C  12  Standard 40 deg Flat Fan, Low Speed
      DATA D01(1:15,12,1) /
     $     219.2090,    38.1154,   -38.7851,   -10.9278,   -14.2993,
     $     -25.0927,   -43.2451,   -10.7028,     3.5065,   -11.1857,
     $      -2.8698,   -22.6977,   -10.6575,    15.8893,     8.2586 /
      DATA D05(1:15,12,1) /
     $     532.2048,   127.1317,   -88.4597,   -52.2890,   -31.6465,
     $     -63.6109,   -87.5149,   -22.5466,    -7.2111,   -33.8692,
     $     -11.6919,   -55.9386,   -36.2134,    34.9032,    23.6741 /
      DATA D09(1:15,12,1) /
     $    1003.4351,   286.7619,  -176.5221,  -104.6982,   -45.6296,
     $    -130.6292,  -161.4786,   -43.8831,   -15.2080,   -51.2262,
     $     -45.6947,  -102.7990,   -73.6892,    57.8212,    21.5332 /
C
C  12  Standard 40 deg Flat Fan, High Speed
      DATA D01(1:15,12,2) /
     $      85.6050,     9.5838,   -22.1611,    -0.5675,   -38.6737,
     $      -6.5189,     2.0607,     4.1763,    -1.1108,    10.9603,
     $      -2.9472,    -6.7162,     0.1304,    -2.8350,    14.2790 /
      DATA D05(1:15,12,2) /
     $     223.0998,    39.6139,   -52.0487,     2.7982,   -80.8006,
     $     -18.2936,     3.1661,     6.7145,   -11.7949,    20.8692,
     $      -9.8552,   -27.7919,     3.3160,    -7.1113,    24.2098 /
      DATA D09(1:15,12,2) /
     $     401.7905,    95.0661,   -86.9949,    13.9648,  -165.1400,
     $     -23.7840,     8.1268,    14.5744,   -41.6656,    32.2290,
     $     -31.8123,   -53.4737,     0.5432,    -6.8031,    60.2964 /
C
C  13  Standard 80 deg Flat Fan, Low Speed
      DATA D01(1:15,13,1) /
     $     189.0771,    30.1322,   -25.7268,   -22.6996,    -4.2194,
     $     -20.8432,   -14.9435,     4.2241,    -6.4096,   -14.5150,
     $       4.7882,   -12.5983,   -19.7806,    10.0446,    11.0114 /
      DATA D05(1:15,13,1) /
     $     447.3847,    98.9494,   -66.4414,   -67.6708,   -14.2352,
     $     -48.9183,   -26.3114,     3.7547,    -6.4669,   -49.2789,
     $      -0.0447,   -26.0414,   -37.2032,    18.4091,    29.7612 /
      DATA D09(1:15,13,1) /
     $     828.3361,   224.5706,  -134.4893,  -124.0067,   -23.5435,
     $     -96.0396,   -61.9558,    -1.9103,    -5.3595,   -98.2529,
     $     -19.8523,   -60.7665,   -59.4007,    33.3003,    49.5288 /
C
C  13  Standard 80 deg Flat Fan, High Speed
      DATA D01(1:15,13,2) /
     $      80.8321,     9.1462,   -17.1935,    -1.6631,   -29.1637,
     $      -6.2031,     1.1153,     2.2330,    -3.0050,     7.0658,
     $      -1.6830,    -6.3633,     0.9181,    -4.6214,     7.9518 /
      DATA D05(1:15,13,2) /
     $     206.7940,    36.0787,   -40.2681,    -2.2977,   -60.0826,
     $     -15.1531,     2.6013,     6.3498,   -13.8201,    12.0695,
     $      -4.9170,   -27.6193,     5.3175,    -8.3008,    12.7407 /
      DATA D09(1:15,13,2) /
     $     370.7755,    83.1137,   -67.9946,    -0.9735,  -124.2550,
     $     -21.6655,     4.6599,    14.2166,   -42.0886,    18.6074,
     $     -15.7443,   -60.1549,    13.0084,   -18.2223,    37.0027 /
C
C  14  Steel Disc Core 45, Low Speed
      DATA D01(1:15,14,1) /
     $     141.2940,     9.0150,   -13.0482,   -21.8904,    -0.2961,
     $       2.0591,     4.7770,     5.3678,     6.8301,   -13.1945,
     $      -5.9718,   -44.9287,   -21.6401,    23.9877,    14.4089 /
      DATA D05(1:15,14,1) /
     $     320.1517,    26.4099,   -31.0593,   -56.2240,    -3.9012,
     $       1.3091,     8.8552,    11.5187,    15.1809,   -24.9650,
     $     -17.4779,  -102.5288,   -46.9628,    60.0668,    33.4057 /
      DATA D09(1:15,14,1) /
     $     590.6633,    54.1280,   -87.3800,  -124.0402,    21.1935,
     $       6.7267,    20.7644,    14.6982,    50.3746,   -58.1541,
     $     -50.7494,  -242.1562,   -84.9703,   155.0652,    91.7618 /
C
C  14  Steel Disc Core 45, High Speed
      DATA D01(1:15,14,2) /
     $      71.0799,     6.4083,   -17.7778,    -0.9842,    -8.4958,
     $      -4.1465,     0.8324,     1.1640,     0.3771,    -1.0905,
     $      -1.5370,    -2.4765,     3.6690,    -0.6723,    -3.4718 /
      DATA D05(1:15,14,2) /
     $     179.4539,    23.3016,   -35.5582,    -2.0272,   -18.6902,
     $     -11.8213,    -0.5539,     3.4291,     3.7223,    -0.2894,
     $      -2.1974,   -14.5659,     4.3920,    -0.8980,    -8.3191 /
      DATA D09(1:15,14,2) /
     $     350.5049,    54.7634,   -63.1450,    -0.3905,   -21.3941,
     $     -23.7092,    -0.5156,     5.0489,    18.2123,     2.3434,
     $      -2.6417,   -34.5221,     8.2468,     3.8306,   -44.7582 /
C
C  15  Steel Disc Core Straight Stream, Low Speed
      DATA D01(1:15,15,1) /
     $     316.0828,  -101.9753,  -121.2104,    -2.4552,   -36.2270,
     $      42.9951,    23.3482,    58.2463,    46.2737,    57.3570,
     $      18.1989,    42.0444,     3.2827,    22.8899,    -7.9825 /
      DATA D05(1:15,15,1) /
     $     810.1446,  -152.4594,  -232.5830,    33.8688,   -76.8843,
     $      30.9014,   -13.9102,    40.9420,    53.7618,    57.8952,
     $       2.0886,   -45.3627,    -7.4172,    11.9595,   -25.1732 /
      DATA D09(1:15,15,1) /
     $    1627.5020,  -146.1070,  -324.7393,    79.7531,  -104.7136,
     $      -6.1386,   -58.9325,    52.8414,     8.4226,    78.9415,
     $      -1.6423,  -289.2715,   -60.0209,    54.3311,   -69.4948 /
C
C  15  Steel Disc Core Straight Stream, High Speed
      DATA D01(1:15,15,2) /
     $     127.1902,   -13.2551,   -57.6130,    17.3427,   -56.9436,
     $       6.3486,    -3.4020,    -9.1232,    23.8405,    33.3496,
     $     -16.2674,   -16.0818,    16.3050,     2.3867,    17.4202 /
      DATA D05(1:15,15,2) /
     $     316.8280,   -18.5167,  -131.2386,    46.8677,  -123.7916,
     $      11.7241,    -9.7310,   -26.8683,    39.6215,    68.3374,
     $     -39.4591,   -34.7703,    37.8759,     1.0887,    34.0364 /
      DATA D09(1:15,15,2) /
     $     635.7534,    12.3147,  -246.1203,   112.5647,  -228.9850,
     $      12.0348,   -10.6156,   -76.5128,    44.0848,   127.3541,
     $    -102.1510,   -69.1006,    72.2824,    13.5266,    19.0394 /
C
C  Csub1 and Cdiv1 Orifice
      DATA CSUB1 /
     $   6.0,    6.0,   0.117 ,   0.117,  0.117,  12.0,  16.0,  16.0,
     $  15.5, 0.0935,   0.0935,    16.0,   16.0,   9.0,   9.0,
     $   6.0,    6.0,   0.117 ,   0.117,  0.117,  12.0,  17.0,  16.0,
     $  15.5, 0.0935,   0.0935,    16.0,   16.0,   9.0,   7.0 /
      DATA CDIV1 /
     $   4.0,    4.0,   0.055 ,   0.055,  0.055,   8.0,  14.0,  14.0,
     $   9.5, 0.0315,   0.0315,    14.0,   14.0,   7.0,   7.0,
     $   4.0,    4.0,   0.055 ,   0.055,  0.055,   8.0,  13.0,  14.0,
     $   9.5, 0.0315,   0.0315,    14.0,   14.0,   7.0,   5.0 /
C
C  Csub2 and Cdiv2 Air Speed
      DATA CSUB2 /
     $   85.0, 100.0,  85.0,  85.0,  95.0,  85.0,  85.0,  85.0,
     $  100.0,  85.0,  95.0,  85.0,  85.0,  85.0, 100.0,
     $  150.0, 100.0, 150.0, 150.0,  95.0, 150.0, 150.0, 150.0,
     $  150.0, 150.0,  95.0, 150.0, 150.0, 150.0, 150.0 /
      DATA CDIV2 /
     $   35.0,  20.0,  35.0,  35.0,  25.0,  35.0,  35.0,  35.0,
     $   20.0,  35.0,  25.0,  35.0,  35.0,  35.0,  20.0,
     $   30.0,  20.0,  30.0,  30.0,  25.0,  30.0,  30.0,  30.0,
     $   30.0,  30.0,  25.0,  30.0,  30.0,  30.0,  30.0 /
C
C  Csub3 and Cdiv3 Pressure
      DATA CSUB3 /
     $   45.0,  45.0,  45.0,  45.0,  45.0,  45.0,  45.0,  45.0,
     $   45.0,  45.0,  45.0,  45.0,  45.0,  45.0,  45.0,
     $   60.0,  45.0,  60.0,  60.0,  45.0,  60.0,  60.0,  60.0,
     $   60.0,  60.0,  45.0,  60.0,  60.0,  60.0,  60.0 /
      DATA CDIV3 /
     $   15.0,  15.0,  15.0,  15.0,  15.0,  15.0,  15.0,  15.0,
     $   15.0,  15.0,  15.0,  15.0,  15.0,  15.0,  15.0,
     $   30.0,  15.0,  30.0,  30.0,  15.0,  30.0,  30.0,  30.0,
     $   30.0,  30.0,  15.0,  30.0,  30.0,  30.0,  30.0 /
C
C  Csub4 and Cdiv4 Orientation
      DATA CSUB4 /
     $   22.5,   7.5,  60.0,  17.5,   0.0,  22.5,  22.5,  22.5,
     $    7.5,  33.75,  0.0,  22.5,  22.5,  22.5,   7.5,
     $   45.0,   7.5,  60.0,  15.0,   0.0,  45.0,  45.0,  45.0,
     $   22.5,  22.5,   0.0,  45.0,  45.0,  45.0,  22.5 /
      DATA CDIV4 /
     $   22.5,   7.5,  30.0,  12.5,   1.0,  22.5,  22.5,  22.5,
     $    7.5,  11.25,  1.0,  22.5,  22.5,  22.5,   7.5,
     $   45.0,   7.5,  30.0,  15.0,   1.0,  45.0,  45.0,  45.0,
     $   22.5,  22.5,   1.0,  45.0,  45.0,  45.0,  22.5 /
C
      DATA IANG / 2,2,1,1,1,2,2,2,2,1,1,2,2,2,2 /
      DATA ANG / 'Deflector Angle','Nozzle Body Angle',
     $           'Deflector Angle (deg)','Nozzle Body Angle (deg)' /
      DATA ICHR / 15,17,21,23 /
C
C  Set all of the necessary parameters for USDA ARS regressions
C
      IER=0
C
      N=BBK.NOZTYPE+1
C
      IF (LFL.EQ.0) THEN
        S=BBK.SPEED
        IF (S/0.447.LT.120.0) THEN
          NS=1
        ELSE
          NS=2
        ENDIF
        I=IANG(N)
        CHSTR=ANG(I,1)
        JCHSTR=ICHR(I,1)
        RETURN
      ENDIF
C
      S=BBK.SPEED
      IF (LFL.EQ.1) THEN
        FAC=1.0
        IF (IUNIT.EQ.0) FAC=1.0/0.447
        SMN=0.447*(CSUB2(N,NS)-CDIV2(N,NS))
        SMX=0.447*(CSUB2(N,NS)+CDIV2(N,NS))
        CALL AGCHK(S,SMN,SMX,SMN,SMX,1,1,IER,FAC,REALWD)
        IF (IER.GT.0) THEN
          IF (IUNIT.EQ.0) THEN
            CHSTR='Air Speed (mph)'
          ELSE
            CHSTR='Air Speed (m/s)'
          ENDIF
          JCHSTR=15
          RETURN
        ENDIF
        LFL=2
        X2=(S/0.447-CSUB2(N,NS))/CDIV2(N,NS)
      ENDIF
C
      O=BBK.ORIFICE
      IF (LFL.EQ.2) THEN
        SMN=CSUB1(N,NS)-CDIV1(N,NS)
        SMX=CSUB1(N,NS)+CDIV1(N,NS)
        CALL AGCHK(O,SMN,SMX,SMN,SMX,1,1,IER,1.0,REALWD)
        IF (IER.GT.0) THEN
          CHSTR='Orifice Size'
          JCHSTR=12
          RETURN
        ENDIF
        LFL=3
        X1=(O-CSUB1(N,NS))/CDIV1(N,NS)
      ENDIF
C
      P=BBK.PRESSURE
      IF (LFL.EQ.3) THEN
        FAC=1.0
        SMN=(CSUB3(N,NS)-CDIV3(N,NS)+14.7)/14.5
        SMX=(CSUB3(N,NS)+CDIV3(N,NS)+14.7)/14.5
        CALL AGCHK(P,SMN,SMX,SMN,SMX,1,1,IER,FAC,REALWD)
        IF (IER.GT.0) THEN
          IF (IUNIT.EQ.0) THEN
            CHSTR='Nozzle Pressure (psig)'
            REALWD(1:3)=14.5*REALWD(1:3)-14.7
            JCHSTR=22
          ELSE
            CHSTR='Nozzle Pressure (bar)'
            JCHSTR=21
          ENDIF
          RETURN
        ENDIF
        LFL=4
        X3=(14.5*P-14.7-CSUB3(N,NS))/CDIV3(N,NS)
      ENDIF
C
      A=BBK.NOZANGLE
      IF (LFL.EQ.4) THEN
        SMN=CSUB4(N,NS)-CDIV4(N,NS)
        SMX=CSUB4(N,NS)+CDIV4(N,NS)
        CALL AGCHK(A,SMN,SMX,SMN,SMX,1,1,IER,1.0,REALWD)
        IF (IER.GT.0) THEN
          I=IANG(N)
          CHSTR=ANG(I,2)
          JCHSTR=ICHR(I,2)
          RETURN
        ENDIF
        LFL=5
        X4=(A-CSUB4(N,NS))/CDIV4(N,NS)
      ENDIF
C
C  Compute the USDA ARS parameters and construct the distribution
C
      IF (LFL.EQ.5) THEN
        YD01=D01(1,N,NS)+D01(2,N,NS)*X1+D01(3,N,NS)*X2
     $      +D01(4,N,NS)*X3+D01(5,N,NS)*X4+D01(6,N,NS)*X1*X2
     $      +D01(7,N,NS)*X1*X3+D01(8,N,NS)*X2*X3+D01(9,N,NS)*X1*X4
     $      +D01(10,N,NS)*X2*X4+D01(11,N,NS)*X3*X4+D01(12,N,NS)*X1*X1
     $      +D01(13,N,NS)*X2*X2+D01(14,N,NS)*X3*X3+D01(15,N,NS)*X4*X4
C
        YD05=D05(1,N,NS)+D05(2,N,NS)*X1+D05(3,N,NS)*X2
     $      +D05(4,N,NS)*X3+D05(5,N,NS)*X4+D05(6,N,NS)*X1*X2
     $      +D05(7,N,NS)*X1*X3+D05(8,N,NS)*X2*X3+D05(9,N,NS)*X1*X4
     $      +D05(10,N,NS)*X2*X4+D05(11,N,NS)*X3*X4+D05(12,N,NS)*X1*X1
     $      +D05(13,N,NS)*X2*X2+D05(14,N,NS)*X3*X3+D05(15,N,NS)*X4*X4
C
        YD09=D09(1,N,NS)+D09(2,N,NS)*X1+D09(3,N,NS)*X2
     $      +D09(4,N,NS)*X3+D09(5,N,NS)*X4+D09(6,N,NS)*X1*X2
     $      +D09(7,N,NS)*X1*X3+D09(8,N,NS)*X2*X3+D09(9,N,NS)*X1*X4
     $      +D09(10,N,NS)*X2*X4+D09(11,N,NS)*X3*X4+D09(12,N,NS)*X1*X1
     $      +D09(13,N,NS)*X2*X2+D09(14,N,NS)*X3*X3+D09(15,N,NS)*X4*X4
C
C  Compute with D01,D05,D09
C
        LTEM=BBK.SPRTYPE
        CALL AGPARX(LTEM,ICLS,YD05,(YD09-YD01)/YD05,NPTS,DDV,XXV)
      ENDIF
      LFL=6
      RETURN
      END